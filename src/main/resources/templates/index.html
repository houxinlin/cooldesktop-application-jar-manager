<!DOCTYPE html>
<html lang="en">
<head>
        <base href="/asr/100005/static/">
    <meta charset="UTF-8">
    <title>Jar管理</title>

    <link rel="stylesheet" href="index.css">
    <link rel="stylesheet" href="element.css">
    <script src="vue.js"></script>
    <script src="element.js"></script>
    <style>
        ::-webkit-scrollbar {
            width: 7px;
        }

        ::-webkit-scrollbar-track {
            background: #00000000;
            border-radius: 2px;
        }

        ::-webkit-scrollbar-thumb {
            background: #ff6c6c;
            border-radius: 13px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #d85353;
        }
        body {
            /*background: #d972728a;*/
        }
        .el-table td.el-table__cell, .el-table th.el-table__cell.is-leaf{
            border-bottom: 1px #ffffff2e solid;
        }

        .el-table th.el-table__cell{
            background: transparent;
            color: #ffffff;
        }
        .el-table--enable-row-hover .el-table__body tr:hover>td.el-table__cell{
            background: transparent;

        }
        .el-table {
            background-color: transparent;
            color: #ffffff;
        }
        .el-table th, .el-table tr, .el-table td {
            border: 0;
            background-color: transparent;
        }

        .el-table th, .el-table tr {
            background-color: transparent;
        }
    </style>
</head>
<body>
<div id="app">
    <el-table :data="tableData">
        <el-table-column prop="name" label="名称"></el-table-column>
        <el-table-column prop="name" label="参数">
            <template #default="scope">
                <el-button size="small" type="success" @click="viewPropertiesClick(scope.$index, scope.row)">查看</el-button>
            </template>
        </el-table-column>
        <el-table-column label="操作">
            <template #default="scope">
                <el-button size="small" type="warning" @click="handlerStopClick(scope.$index, scope.row)">终止</el-button>
            </template>
        </el-table-column>
    </el-table>

    <el-dialog
            v-model="dialogVisible"
            title="参数"
            width="40%"
            :before-close="handleClose">
        <span>
            <div style="margin-bottom: 10px;border-bottom: 1px #f1f1f1 solid;" v-for="(val,key,i) in properties"
                 :key="i">
                {{key}} : {{val}}
            </div>
        </span>
        <template #footer>
            <span class="dialog-footer">
                <el-button type="primary" @click="dialogVisible = false">确定</el-button>
            </span>
        </template>
    </el-dialog>

</div>
<script>
    let rootPath = "/100005/"
    // let rootPath = ""
    let jarApp = null
    let app = {
        data() {
            return {
                dialogVisible: false,
                tableData: [],
                counter: 0,
                properties: []
            }
        },
        created() {
            let that = this

            setInterval(function () {
                fetch(`${rootPath}/list`).then(data => data.json())
                    .then((data) => {
                        that.counter++
                        that.tableData = data
                    })
            }, 1000)
        },
        methods: {
            handlerStopClick(index, row) {
                fetch(`${rootPath}/stop`, {
                    headers: {'Content-Type': 'application/x-www-form-urlencoded'},
                    method: "POST",
                    body: `id=${row.id}`
                }).then(data => data.json()).then((data) => {
                })
            },
            viewPropertiesClick(index, row) {
                this.dialogVisible = true
                this.properties = row.properties
            }
        },

    }
    jarApp = Vue.createApp(app)
    jarApp.use(ElementPlus);
    jarApp.mount("#app")
</script>
</body>
</html>